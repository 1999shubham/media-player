<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MediaPlayer - OpenHome UPnP Media Renderer</title>
    <meta name="description" content="Website generator">

    <link href="http://petemanchester.github.io/MediaPlayer/css/bootstrap.min.css" rel="stylesheet">
    <link href="http://petemanchester.github.io/MediaPlayer/google-code-prettify/prettify.css" rel="stylesheet">
    <link href="http://petemanchester.github.io/MediaPlayer/css/theme.css" rel="stylesheet">
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <a href="http://petemanchester.github.io/MediaPlayer/" class="navbar-brand">MediaPlayer</a>
                <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
            </div>
            <div class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    <li><a href="http://petemanchester.github.io/MediaPlayer/">Home</a></li>
                    <li><a href="http://petemanchester.github.io/MediaPlayer/docs/">Documentation</a></li>
                    <li><a href="https://github.com/PeteManchester/MediaPlayer">GitHub</a></li>
                </ul>
            </div>
        </div>
    </div>

    
        <div class="container">
            <section>
                <h1>Setup MediaPlayer on ArchLinux (Raspberry Pi/cubox-i)</h1>
<p>Since I am using ArchLinux this installation instruction covers this distribution.</p>
<h2>Setup ArchLinux</h2>
<pre><code>[Downloads]$ sudo dd bs=1M if=ArchLinuxARM-2014.03-rpi.img of=/dev/mmcblk0</code></pre>
<p>see <a href="http://archlinuxarm.org/platforms/armv6/raspberry-pi">http://archlinuxarm.org/platforms/armv6/raspberry-pi</a> or
<a href="http://archlinuxarm.org/platforms/armv7/freescale/cubox-i">http://archlinuxarm.org/platforms/armv7/freescale/cubox-i</a>
for additional hints</p>
<pre><code>ssh root@alarmpi</code></pre>
<h2>Setup Java</h2>
<p>If you do not like to use the fullscreen display, the package jre7-openjdk-headless
is enough ;-)</p>
<pre><code>[root@alarmpi]# pacman -S jre7-openjdk</code></pre>
<h2>Setup MPD</h2>
<pre><code>[root@alarmpi]# pacman -S mpd
[root@alarmpi]# pacman -S alsa-plugins alsa-utils alsaplayer alsa-tools</code></pre>
<p>This will bring up (at least on the cubox-i) a question on the libgl provider,
I have chosen to use mesa-libgl. Could be, that you are better off with another
setting.</p>
<p>An example configuration for raspberry pi is shown here.</p>
<pre><code>user "mpd"
pid_file "/run/mpd/mpd.pid"
#db_file "/var/lib/mpd/mpd.db"
state_file "/var/lib/mpd/mpdstate"
playlist_directory "/var/lib/mpd/playlists"
log_file "/var/log/mpd.log"

audio_output {
    type "alsa"
    name "PiALSA"
    device "hw:0,0"
}</code></pre>
<p>An example configuration for cubox-i is shown here:</p>
<pre><code>user "mpd"
pid_file "/run/mpd/mpd.pid"
#db_file "/var/lib/mpd/mpd.db"
state_file "/var/lib/mpd/mpdstate"
playlist_directory "/var/lib/mpd/playlists"
log_file "/var/log/mpd.log"

audio_output {
   type   "alsa"
   name   "SPDIF out"
   device   "hw:0,0"
}</code></pre>
<p>On a cubox-i this config will work, but could lead to errors in the log file
(/var/log/mpd.log):</p>
<pre><code>alsa_mixer: Failed to read mixer for 'SPDIF out': no such mixer control: PCM</code></pre>
<p>Please note, that the default db is disabled, and MPD is configured to use the
"usual" audio output of the Raspberry Pi/cubox-i. If you are using a different USB
Audio Device, this should most probably be adopted.</p>
<p>Enable automatic startup of mpd after a reboot.</p>
<pre><code>systemctl start mpd.service
systemctl enable mpd.service</code></pre>
<h2>Setup MediaPlayer</h2>
<p>We are going to use the latest beta version in this install. If you would like to
use a "stable" version, please replace "beta" with "release".</p>
<pre><code>[root@alarmpi]# pacman -S binutils
[root@alarmpi]# pacman -S unzip
[root@alarmpi]# wget -O mediaplayer.zip https://github.com/PeteManchester/MediaPlayer/blob/master/com.upnp.mediaplayer/download/beta/mediaplayer.zip?raw=true
[root@alarmpi]# unzip mediaplayer.zip
[root@alarmpi]# mv mediaplayer /opt
[root@alarmpi]# cd /opt/mediaplayer
[root@alarmpi]# chmod +x run.s</code></pre>
<p>The app.properties needs to get adopted, so that it fits your needs. An example is
shown beneath.</p>
<pre><code>friendly.name=Raspberry Pi (Wohnzimmer)
#player can be either mpd or mplayer
player=mpd
#playlist.max, maximum items allow in playlist. Maximum is 1000
playlist.max=1000
save.local.playlist=true
enableAVTransport=true
enableReceiver=false
#mplayer settings
mplayer.playlist=asx,b4s,kpl,m3u,pls,ram,rm,smil,wax,wvx
mplayer.path=/usr/bin/mplayer
mplayer.cache=520
mplayer.cache_min=80
#mpd settings
mpd.host=localhost
mpd.port=6600
mpd.preload.timer=3
#log settings
log.file=/var/log/mediaplayer.log
#off,debug,info,warn,error,fatal
log.file.level=warn
log.console.level=off
#OpenHome settings
#Log Level can be: None, Trace, Thread, Network, Timer, SsdpMulticast, SsdpUnicast, Http, Device,
#XmlFetch, Service, Event, Topology, DvInvocation, DvEvent, DvWebSocket, Bonjour, DvDevice, Error, All, Verbose
openhome.debug.level=Error
openhome.port=52821</code></pre>
<p>The above configuration uses MPD as the media playing device.</p>
<h3>Enable MediaPlayer on Boot</h3>
<pre><code>[root@alarmpi]# cd /opt/mediaplayer/scripts/systemd
[root@alarmpi]# cp mediaplayer.service /etc/systemd/system/
[root@alarmpi]# cp run_systemd.sh /opt/mediaplayer
[root@alarmpi]# chmod +x /opt/mediaplayer/run_systemd.sh</code></pre>
<p>Adopt the mediaplayer.service in /etc/systemd/system/multi-user.target.wants to
reflect your local environment:</p>
<pre><code>[Unit]
Description=MediaPlayer
Requires=mpd.service
After=network.target mpd.service

[Service]
Type=forking
ExecStart=/opt/mediaplayer/run_systemd.sh

[Install]
WantedBy=multi-user.target</code></pre>
<p>Now start the mediaplayer service:</p>
<pre><code>[root@alarmpi]# systemctl start mediaplayer.service
[root@alarmpi]# systemctl enable mediaplayer.service</code></pre>
<h2>Enable Plugins</h2>
<p>MediaPlayer provides a lot of <a href="https://github.com/PeteManchester/MediaPlayer/wiki">Plugins</a>
which need to be installed separately and on request. In the following we enable the
LastFM Plugin to scrobble the played tracks.</p>
<pre><code>[root@alarmpi]# cd /opt/mediaplayer
[root@alarmpi]# mkdir -p plugins/LastFM
[root@alarmpi]# cd plugins/LastFM
[root@alarmpi]# wget -O LastFM.jar https://github.com/PeteManchester/MediaPlayer/raw/master/com.upnp.mediaplayer/plugins/LastFM/LastFM.jar
[root@alarmpi]# wget -O LastFM.xml https://github.com/PeteManchester/MediaPlayer/raw/master/com.upnp.mediaplayer/plugins/LastFM/LastFM.xml</code></pre>
<p>For the LastFM plugin to work, you need to adopt the LastFM.xml according to your
personal preferences. For a detailed description, please see the
<a href="https://github.com/PeteManchester/MediaPlayer/wiki/Plugins-LastFM">LastFM Documentation</a>.</p>
<h2>Adjust Date/Time Settings</h2>
<p>The timezone of the default install of ArchlinuxARM is America/Denver. If you are
in a different timezone, you need to adjust this.</p>
<pre><code>[root@alarmpi]# timedatectl set-timezone Europe/Berlin</code></pre>
<p>For detailled information, please take a look on the <a href="https://wiki.archlinux.org/index.php/time">ArchWiki</a>.</p>
            </section>
        </div>

    
    <footer>
        <div class="container">
            <p class="text-muted">This website was generated using <a href="http://mnapoli.fr/Couscous/">Couscous</a>.</p>
        </div>
    </footer>

    <script src="http://petemanchester.github.io/MediaPlayer/js/jquery-1.10.2.min.js"></script>
    <script src="http://petemanchester.github.io/MediaPlayer/js/bootstrap.min.js"></script>
    <script src="http://petemanchester.github.io/MediaPlayer/google-code-prettify/prettify.js"></script>

    <script>
        $(function() {
            $("section h1").wrap('<div class="page-header" />');
            $("section p:first-child").addClass('lead');
            $("pre").addClass('prettyprint');
            prettyPrint();
        });
    </script>

</body>
</html>